<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mortgage Price Analyzer</title>
  <link rel="stylesheet" href="/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <aside class="sidebar">
    <div class="sidebar-header">
      <h1>UWM Analyzer</h1>
    </div>
    <nav class="sidebar-nav">
      <button class="nav-item active" data-tab="analyze">Database Analysis</button>
      <button class="nav-item" data-tab="builder">Payload Builder</button>
      <button class="nav-item" data-tab="customers">Manage Customers</button>
    </nav>
  </aside>

  <main class="main-content">
    <!-- Database Analysis Page -->
    <section id="analyzeSection" class="tab-content active">
      <div class="page-header">
        <h2>Database Analysis</h2>
        <p>Run batch analysis on your entire customer database using a payload template.</p>
      </div>

      <div class="card">
        <form id="analyzeForm">
          <div class="form-row">
            <div class="form-group">
              <label for="analyzePayloadSelect">Select Payload Template</label>
              <select id="analyzePayloadSelect" name="analyzePayloadSelect">
                <option value="">-- Select a Template --</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="min_savings">Min Monthly Savings ($)</label>
              <input type="number" id="min_savings" name="min_savings" value="200" step="10" />
            </div>
            <div class="form-group">
              <label for="target_amount">Target Amount ($)</label>
              <input type="number" id="target_amount" name="target_amount" value="-2000" step="100" />
            </div>
            <div class="form-group">
              <label for="tolerance">Tolerance ($)</label>
              <input type="number" id="tolerance" name="tolerance" placeholder="Optional" step="10" />
            </div>
          </div>

          <button type="submit" id="submitBtn" class="btn-primary">Start Batch Analysis</button>
        </form>
      </div>

      <div id="resultsSection" class="results-overlay hidden">
        <h3>Analysis Results</h3>
        <div id="resultsContainer"></div>
      </div>
    </section>

    <!-- Payload Builder Page -->
    <!-- Payload Builder Page -->
    <section id="builderSection" class="tab-content">
      <div class="page-header">
        <h2>Payload Builder</h2>
        <p>Design and test custom API request templates.</p>
      </div>

      <div class="card">
        <div class="form-row">
          <div class="form-group">
            <label for="payloadSelect">Saved Templates</label>
            <div style="display: flex; gap: 0.5rem;">
              <select id="payloadSelect">
                <option value="">-- Select a Template --</option>
              </select>
              <button type="button" id="deletePayloadBtn" class="btn-danger" style="width: auto;">Delete</button>
            </div>
          </div>
          <div class="form-group">
            <label for="jsonImportText">Import JSON</label>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
              <textarea id="jsonImportText" placeholder="Paste JSON payload here..." rows="8" style="font-family: monospace; font-size: 0.8rem;"></textarea>
              <button type="button" id="loadJsonBtn" class="btn-secondary">Load JSON into Form</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <form id="builderForm">
          <div class="form-row">
            <div class="form-group">
              <label for="payloadName">Template Name</label>
              <input type="text" id="payloadName" placeholder="e.g. FHA Cash Out" />
            </div>
          </div>

          <!-- Section 1: Basic Information -->
          <h3 class="section-title">Basic Information</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Borrower Name</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="borrowerName" checked />
                <div class="field-content">
                  <input type="text" id="borrowerName" name="borrowerName" value="John Homeowner" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Broker Alias</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="brokerAlias" checked />
                <div class="field-content">
                  <input type="text" id="brokerAlias" name="brokerAlias" value="ABC123" />
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Loan Officer Email</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="loanOfficer" checked />
                <div class="field-content">
                  <input type="text" id="loanOfficer" name="loanOfficer" value="lofficer@email.com" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Loan Amount ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="loanAmount" checked />
                <div class="field-content">
                  <input type="number" id="loanAmount" name="loanAmount" value="300000" />
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Sales Price ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="salesPrice" checked />
                <div class="field-content">
                  <input type="number" id="salesPrice" name="salesPrice" value="325000" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Appraised Value ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="appraisedValue" checked />
                <div class="field-content">
                  <input type="number" id="appraisedValue" name="appraisedValue" value="325000" />
                </div>
              </div>
            </div>
          </div>

          <!-- Section 2: Loan Details -->
          <h3 class="section-title">Loan Details</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Loan Type (Array)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="loanTypeIds" checked />
                <div class="field-content">
                  <select id="loanTypeIds" name="loanTypeIds" multiple>
                    <option value="0" selected>Conventional</option>
                    <option value="1">Conventional ARM</option>
                    <option value="2">FHA</option>
                    <option value="3">FHA ARM</option>
                    <option value="4">VA</option>
                    <option value="5">VA ARM</option>
                    <option value="6">USDA</option>
                  </select>
                  <div class="hint">Hold Ctrl (Windows) / ⌘ (Mac) to select multiple</div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Loan Term Ids (Array)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="loanTermIds" checked />
                <div class="field-content">
                  <select id="loanTermIds" name="loanTermIds" multiple>
                    <option value="5">40 Years (Conventional only)</option>
                    <option value="4" selected>30 Years</option>
                    <option value="3">25 Years</option>
                    <option value="2">20 Years</option>
                    <option value="1">15 Years</option>
                    <option value="0">10 Years</option>
                  </select>
                  <div class="hint">Hold Ctrl (Windows) / ⌘ (Mac) to select multiple</div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Purpose</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="purposeTypeID" checked />
                <div class="field-content">
                  <select id="purposeTypeID" name="purposeTypeID">
                    <option value="1">Purchase Home</option>
                    <option value="3" selected>Refinance 1st Mortgage</option>
                    <option value="6">Construction Purchase</option>
                    <option value="12">Construction Refinance</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Refinance Purpose</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="refinancePurposeId" checked />
                <div class="field-content">
                  <select id="refinancePurposeId" name="refinancePurposeId">
                    <option value="Cash Out">Cash Out</option>
                    <option value="Rate And Term Reduction-CONV" selected>Rate And Term Reduction-CONV</option>
                    <option value="Rate And Term Reduction-FHA">Rate And Term Reduction-FHA</option>
                    <option value="Streamline Refinance">Streamline Refinance</option>
                    <option value="VA Interest Rate Reduction">VA Interest Rate Reduction</option>
                    <option value="VA Cash Out - Type I">VA Cash Out - Type I</option>
                    <option value="VA Cash Out - Type II">VA Cash Out - Type II</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Section 3: Property Details -->
          <h3 class="section-title">Property Details</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Property Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="propertyTypeId" checked />
                <div class="field-content">
                  <select id="propertyTypeId" name="propertyTypeId">
                    <option value="22" selected>Single Family Residence</option>
                    <option value="25">2–4 Unit Dwelling</option>
                    <option value="30">Cooperative</option>
                    <option value="32">PUD</option>
                    <option value="34">Condominium</option>
                    <option value="38">Modular</option>
                    <option value="48">Site Condo</option>
                    <option value="52">Manufactured Condo Single Wide</option>
                    <option value="53">Manufactured PUD Single Wide</option>
                    <option value="54">Manufactured Single Wide</option>
                    <option value="55">Manufactured Multi Wide</option>
                    <option value="56">Manufactured Condo Multi Wide</option>
                    <option value="57">Manufactured PUD Multi Wide</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Occupancy</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="occupancyTypeId" checked />
                <div class="field-content">
                  <select id="occupancyTypeId" name="occupancyTypeId">
                    <option value="1" selected>Primary Residence</option>
                    <option value="2">Investment Property</option>
                    <option value="3">Secondary Residence</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Number of Units</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="numberOfUnits" checked />
                <div class="field-content">
                  <input type="number" id="numberOfUnits" name="numberOfUnits" value="1" min="1" max="4" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Attachment Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="attachmentTypeId" checked />
                <div class="field-content">
                  <select id="attachmentTypeId" name="attachmentTypeId">
                    <option value="0" selected>Attached</option>
                    <option value="1">Detached</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Zip Code</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="propertyZipCode" checked />
                <div class="field-content">
                  <input type="text" id="propertyZipCode" name="propertyZipCode" value="48341" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Credit Score</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="creditScore" checked />
                <div class="field-content">
                  <input type="number" id="creditScore" name="creditScore" value="750" min="300" max="850" />
                </div>
              </div>
            </div>
          </div>

          <!-- Section 4: Financial Details -->
          <h3 class="section-title">Financial Details</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Monthly Income ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="monthlyIncome" checked />
                <div class="field-content">
                  <input type="number" id="monthlyIncome" name="monthlyIncome" value="4000" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Current Monthly Payment ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="currentMonthlyPayment" checked />
                <div class="field-content">
                  <input type="number" id="currentMonthlyPayment" name="currentMonthlyPayment" value="2000" />
                  <div class="hint">NOT sent to API</div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Monthly Debt ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="monthlyDebt" checked />
                <div class="field-content">
                  <input type="number" id="monthlyDebt" name="monthlyDebt" value="0" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Annual Taxes ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="annualTaxes" checked />
                <div class="field-content">
                  <input type="number" id="annualTaxes" name="annualTaxes" value="0" />
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Annual Homeowners Ins ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="annualHomeownersInsurance" checked />
                <div class="field-content">
                  <input type="number" id="annualHomeownersInsurance" name="annualHomeownersInsurance" value="0" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>APR Fees ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="annualPercentageRateFees" checked />
                <div class="field-content">
                  <input type="number" id="annualPercentageRateFees" name="annualPercentageRateFees" value="0" />
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Number of Financed Properties</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="numberOfFinancedProperties" checked />
                <div class="field-content">
                  <input type="number" id="numberOfFinancedProperties" name="numberOfFinancedProperties" value="1" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>DSCR (Decimal)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="debtServiceCoverageRatio" checked />
                <div class="field-content">
                  <input type="number" id="debtServiceCoverageRatio" name="debtServiceCoverageRatio" value="2.00" step="0.01" />
                </div>
              </div>
            </div>
          </div>

          <!-- Section 5: Lock & Terms -->
          <h3 class="section-title">Lock & Terms</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Lock Period</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="commitmentPeriodId" checked />
                <div class="field-content">
                  <select id="commitmentPeriodId" name="commitmentPeriodId">
                    <option value="13" selected>30-Day</option>
                    <option value="21">8-Day</option>
                    <option value="20">11-Day</option>
                    <option value="12">15-Day</option>
                    <option value="19">22-Day</option>
                    <option value="14">45-Day</option>
                    <option value="15">60-Day</option>
                    <option value="16">90-Day</option>
                    <option value="17">120-Day</option>
                    <option value="18">180-Day</option>
                    <option value="22">150-Day</option>
                    <option value="23">270-Day</option>
                    <option value="24">365-Day</option>
                    <option value="-1">Custom</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Second Loan Amount ($)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="secondLoanAmount" checked />
                <div class="field-content">
                  <input type="number" id="secondLoanAmount" name="secondLoanAmount" value="0" />
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>CYP Bps (0-40)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="controlYourPrice" checked />
                <div class="field-content">
                  <input type="number" id="controlYourPrice" name="controlYourPrice" value="0" min="0" max="40" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Prepayment Penalty</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="prepaymentPenaltyId" checked />
                <div class="field-content">
                  <select id="prepaymentPenaltyId" name="prepaymentPenaltyId">
                    <option value="1" selected>None</option>
                    <option value="2">1 Year Penalty</option>
                    <option value="4">2 Year Penalty</option>
                    <option value="7">3 Year Penalty</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Section 6: Insurance & Fees -->
          <h3 class="section-title">Insurance & Fees</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Mortgage Insurance</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="mortgageInsuranceType" checked />
                <div class="field-content">
                  <select id="mortgageInsuranceType" name="mortgageInsuranceType">
                    <option value="1" selected>BPMI (Monthly)</option>
                    <option value="2">LPMI Lender Paid</option>
                    <option value="3">Split 50</option>
                    <option value="4">Split 100</option>
                    <option value="5">Single Premium</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Waivable Fee Type Ids (Array)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="waivableFeeTypeIds" checked />
                <div class="field-content">
                  <select id="waivableFeeTypeIds" name="waivableFeeTypeIds" multiple>
                    <option value="0" selected>Underwriting Fee</option>
                    <option value="2">TRAC+ Fee</option>
                    <option value="3">PA+ Fee</option>
                  </select>
                  <div class="hint">Hold Ctrl (Windows) / ⌘ (Mac) to select multiple</div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Escrow Waiver</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="escrowWaiverTypeId" checked />
                <div class="field-content">
                  <select id="escrowWaiverTypeId" name="escrowWaiverTypeId">
                    <option value="1" selected>No Waiver</option>
                    <option value="2">Waive Taxes Only</option>
                    <option value="3">Waive Hazard Insurance Only</option>
                    <option value="4">Waive Taxes & Hazard Insurance</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Loan Shield</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="loanShieldTypeId" checked />
                <div class="field-content">
                  <select id="loanShieldTypeId" name="loanShieldTypeId">
                    <option value="0" selected>Do not include Loan Shield</option>
                    <option value="1">Include Loan Shield</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>PA+ Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="paPlusTypeId" checked />
                <div class="field-content">
                  <select id="paPlusTypeId" name="paPlusTypeId">
                    <option value="0" selected>In-House</option>
                    <option value="1">PA+ Full Service</option>
                    <option value="6">PA+ Setup and Underwriting</option>
                    <option value="7">PA+ Setup and Closing</option>
                    <option value="8">PA+ Underwriting and Closing</option>
                    <option value="2">PA+ Setup Only</option>
                    <option value="3">PA+ Underwriting Only</option>
                    <option value="4">PA+ Closing Only</option>
                    <option value="5">Third-Party Processor</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>TRAC Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="tracTypeId" checked />
                <div class="field-content">
                  <select id="tracTypeId" name="tracTypeId">
                    <option value="0" selected>Traditional Lenders Policy</option>
                    <option value="2">TRAC+</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>TRAC Incentive</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="tracIncentiveID" checked />
                <div class="field-content">
                  <select id="tracIncentiveID" name="tracIncentiveID">
                    <option value="">(none)</option>
                    <option value="1">Apply Credit as an LLPA</option>
                    <option value="2">Send Check to Borrower</option>
                    <option value="3">Apply Credit in Fees</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Bank Statement Months</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="monthsOfBankStatementsId" checked />
                <div class="field-content">
                  <select id="monthsOfBankStatementsId" name="monthsOfBankStatementsId">
                    <option value="0" selected>None</option>
                    <option value="12">12 Months</option>
                    <option value="24">24 Months</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Section 7: VA/FHA Specific -->
          <h3 class="section-title">VA/FHA Specific</h3>
          <div class="form-row">
            <div class="form-group">
              <label>VA Funding Fee Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="financedMortgageInsuranceTypeId" checked />
                <div class="field-content">
                  <select id="financedMortgageInsuranceTypeId" name="financedMortgageInsuranceTypeId">
                    <option value="6" selected>Financed</option>
                    <option value="7">Non-Financed</option>
                    <option value="12">Exempt</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>VA Use Type Ids (Array)</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="useMortgageInsuranceTypeIds" checked />
                <div class="field-content">
                  <select id="useMortgageInsuranceTypeIds" name="useMortgageInsuranceTypeIds" multiple>
                    <option value="8" selected>First Use</option>
                    <option value="9">Subsequent Use</option>
                  </select>
                  <div class="hint">Hold Ctrl (Windows) / ⌘ (Mac) to select multiple</div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>FHA Secondary Source</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="federalHousingAdministrationSecondarySourceTypeId" checked />
                <div class="field-content">
                  <select id="federalHousingAdministrationSecondarySourceTypeId" name="federalHousingAdministrationSecondarySourceTypeId">
                    <option value="1" selected>Government</option>
                    <option value="2">Non-Profit</option>
                    <option value="3">Family/Relative</option>
                    <option value="4">Employee/Other</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Months of Reserves</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="monthsOfReservesId" checked />
                <div class="field-content">
                  <input type="number" id="monthsOfReservesId" name="monthsOfReservesId" value="0" step="0.1" />
                </div>
              </div>
            </div>
          </div>

          <!-- Section 8: Target Values & Options -->
          <h3 class="section-title">Target Values & Options</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Exact Rate Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="exactRateTypeId" checked />
                <div class="field-content">
                  <select id="exactRateTypeId" name="exactRateTypeId">
                    <option value="2" selected>Target Price After Compensation</option>
                    <option value="1">Target Rate</option>
                    <option value="0">None</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Buydown Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="buyDownAliasID" checked />
                <div class="field-content">
                  <select id="buyDownAliasID" name="buyDownAliasID">
                    <option value="None" selected>None</option>
                    <option value="1-0">1-0</option>
                    <option value="1-0 LLPA">1-0 LLPA</option>
                    <option value="1-1">1-1</option>
                    <option value="1-1 LLPA">1-1 LLPA</option>
                    <option value="2-1">2-1</option>
                    <option value="2-1 LLPA">2-1 LLPA</option>
                    <option value="3-2-1">3-2-1</option>
                    <option value="3-2-1 LLPA">3-2-1 LLPA</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Target Price Value</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="targetPriceValue" checked />
                <div class="field-content">
                  <input type="number" id="targetPriceValue" name="targetPriceValue" value="0" step="0.001" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Target Cash Value</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="targetCashValue" checked />
                <div class="field-content">
                  <input type="number" id="targetCashValue" name="targetCashValue" value="0" />
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Target Rate Value</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="targetRateValue" checked />
                <div class="field-content">
                  <input type="number" id="targetRateValue" name="targetRateValue" value="0" step="0.001" />
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Compensation Payer</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="compensationPayerTypeID" checked />
                <div class="field-content">
                  <select id="compensationPayerTypeID" name="compensationPayerTypeID">
                    <option value="0">Borrower Paid</option>
                    <option value="1" selected>Lender Paid</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Lease Type</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="leaseTypeId" checked />
                <div class="field-content">
                  <select id="leaseTypeId" name="leaseTypeId">
                    <option value="1" selected>Unleased</option>
                    <option value="2">Long-Term Lease</option>
                    <option value="3">Short-Term Rental</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>Number of Borrowers</label>
              <div class="field-group">
                <input type="checkbox" class="field-toggle" data-field="numberOfBorrowers" checked />
                <div class="field-content">
                  <select id="numberOfBorrowers" name="numberOfBorrowers">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <!-- Section 9: Boolean Options -->
          <h3 class="section-title">Boolean Options</h3>
          <div class="boolean-grid">
            <!-- First Row -->
            <div class="boolean-item">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="checkbox" class="field-toggle" data-field="firstTimeHomeBuyer" checked id="firstTimeHomeBuyerToggle">
                <label for="firstTimeHomeBuyerToggle" style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Include in payload</label>
              </div>
              <label for="firstTimeHomeBuyer" class="boolean-label">
                <input type="checkbox" id="firstTimeHomeBuyer" name="firstTimeHomeBuyer" />
                <span>First Time Homebuyer</span>
              </label>
            </div>

            <div class="boolean-item">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="checkbox" class="field-toggle" data-field="isDTIOver45Percent" checked id="dtiToggle">
                <label for="dtiToggle" style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Include in payload</label>
              </div>
              <label for="isDTIOver45Percent" class="boolean-label">
                <input type="checkbox" id="isDTIOver45Percent" name="isDTIOver45Percent" />
                <span>DTI Over 45%</span>
              </label>
            </div>

            <div class="boolean-item">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="checkbox" class="field-toggle" data-field="selfEmployed" checked id="selfEmployedToggle">
                <label for="selfEmployedToggle" style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Include in payload</label>
              </div>
              <label for="selfEmployed" class="boolean-label">
                <input type="checkbox" id="selfEmployed" name="selfEmployed" />
                <span>Self Employed</span>
              </label>
            </div>

            <!-- Second Row -->
            <div class="boolean-item">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="checkbox" class="field-toggle" data-field="isCorrespondent" checked id="correspondentToggle">
                <label for="correspondentToggle" style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Include in payload</label>
              </div>
              <label for="isCorrespondent" class="boolean-label">
                <input type="checkbox" id="isCorrespondent" name="isCorrespondent" />
                <span>Correspondent</span>
              </label>
            </div>

            <div class="boolean-item">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="checkbox" class="field-toggle" data-field="isFirstTimeInvestor" checked id="firstTimeInvestorToggle">
                <label for="firstTimeInvestorToggle" style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Include in payload</label>
              </div>
              <label for="isFirstTimeInvestor" class="boolean-label">
                <input type="checkbox" id="isFirstTimeInvestor" name="isFirstTimeInvestor" />
                <span>First Time Investor</span>
              </label>
            </div>

            <div class="boolean-item">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="checkbox" class="field-toggle" data-field="waiveUnderwritingFee" checked id="waiveFeeToggle">
                <label for="waiveFeeToggle" style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Include in payload</label>
              </div>
              <label for="waiveUnderwritingFee" class="boolean-label">
                <input type="checkbox" id="waiveUnderwritingFee" name="waiveUnderwritingFee" />
                <span>Waive Underwriting Fee</span>
              </label>
            </div>

            <!-- Third Row -->
            <div class="boolean-item">
              <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                <input type="checkbox" class="field-toggle" data-field="includeFlexTerms" checked id="flexTermsToggle">
                <label for="flexTermsToggle" style="font-size: 0.75rem; color: var(--text-secondary); margin: 0;">Include in payload</label>
              </div>
              <label for="includeFlexTerms" class="boolean-label">
                <input type="checkbox" id="includeFlexTerms" name="includeFlexTerms" />
                <span>Include Flex Terms</span>
              </label>
            </div>
          </div>

          <!-- Action Buttons -->
          <div style="display: flex; gap: 1rem; margin-top: 2rem;">
            <button type="submit" id="buildAnalyzeBtn" class="btn-primary" style="flex: 2;">Test Scenario</button>
            <button type="button" id="savePayloadBtn" class="btn-secondary" style="flex: 1;">Save Template</button>
            <button type="button" id="previewBtn" class="btn-secondary" style="flex: 1;">Preview JSON</button>
          </div>
        </form>
      </div>

      <div id="jsonPreview" class="card hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
          <h3 style="margin: 0;">JSON Preview</h3>
          <button id="downloadBtn" class="btn-secondary" style="width: auto;">Download .json</button>
        </div>
        <pre id="jsonContent" style="background: #1e293b; color: #f8fafc; padding: 1.5rem; border-radius: 0.5rem; overflow: auto; max-height: 400px; font-size: 0.8rem;"></pre>
      </div>
    </section>

    <!-- Customers Page -->
    <section id="customersSection" class="tab-content">
      <div class="page-header">
        <h2>Customer Management</h2>
        <p>Manage your client database and perform individual quote analysis.</p>
      </div>

      <div class="card">
        <form id="customerForm">
          <input type="hidden" id="customerId" />
          <div class="form-row">
            <div class="form-group">
              <label for="cName">Full Name</label>
              <input type="text" id="cName" required />
            </div>
            <div class="form-group">
              <label for="cScore">Credit Score</label>
              <input type="number" id="cScore" min="300" max="850" required />
            </div>
            <div class="form-group">
              <label for="cIncome">Monthly Income ($)</label>
              <input type="number" id="cIncome" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="cPayment">Current Payment ($)</label>
              <input type="number" id="cPayment" required />
            </div>
            <div class="form-group">
              <label for="cBalance">Loan Balance ($)</label>
              <input type="number" id="cBalance" required />
            </div>
            <div class="form-group">
              <label for="cValue">Property Value ($)</label>
              <input type="number" id="cValue" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="cZip">Property Zip</label>
              <input type="text" id="cZip" required />
            </div>
            <div class="form-group">
              <label for="cState">State (2 chars)</label>
              <input type="text" id="cState" maxlength="2" required />
            </div>
            <div class="form-group" style="justify-content: flex-end; align-items: flex-end;">
              <div style="display: flex; gap: 0.5rem; width: 100%;">
                <button type="button" id="cancelCustomerBtn" class="btn-secondary" style="flex: 1;">Cancel</button>
                <button type="submit" id="saveCustomerBtn" class="btn-primary" style="flex: 1;">Add Customer</button>
              </div>
            </div>
          </div>
        </form>
      </div>

      <div class="card">
        <div style="margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
          <input type="text" id="customerSearch" placeholder="Search customers..." style="max-width: 300px;" />
          <span id="customerCountBadge" class="badge badge-blue">0 Customers</span>
        </div>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Income</th>
                <th>Payment</th>
                <th>Credit</th>
                <th>Quick Analysis</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="customerTableBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Result display directly in Manage Customers -->
      <div id="customerAnalysisResults" class="results-overlay hidden">
        <div class="card" style="border-top: 4px solid var(--secondary-color);">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h3 style="margin: 0;">Analysis Results</h3>
            <button onclick="document.getElementById('customerAnalysisResults').classList.add('hidden')" class="btn-secondary" style="width: auto;">Clear Results</button>
          </div>
          <div id="customerResultsContainer"></div>
        </div>
      </div>
    </section>

    <section id="errorSection" class="error-msg hidden">
      <p id="errorMessage" style="margin: 0;"></p>
    </section
  </main>

  <script src="/script.js"></script>
</body>
</html>