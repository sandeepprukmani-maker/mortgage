# ===========================================
# Valargen Server - Environment Variables
# ===========================================
# Copy to .env and configure for your environment

# -----------------------------------------
# Key Vault Configuration
# -----------------------------------------
# Leave empty for local dev (uses env vars below)
# Set to vault name for Azure (uses Managed Identity)
KEY_VAULT_NAME=

# -----------------------------------------
# Database - Local Development
# -----------------------------------------
# Via PgBouncer (recommended for connection pooling)
DATABASE_URL=postgresql://valargen:valargen@localhost:6432/valargen

# -----------------------------------------
# Database - Azure (when using Key Vault)
# -----------------------------------------
# Password fetched from Key Vault, set host/user/db here
# POSTGRES_HOST=valargen-db-staging.postgres.database.azure.com
# POSTGRES_USER=valargenadmin
# POSTGRES_DB=valargen
# POSTGRES_PORT=5432

# -----------------------------------------
# Redis
# -----------------------------------------
REDIS_URL=redis://localhost:6379

# -----------------------------------------
# Storage - Local (Azurite emulator)
# -----------------------------------------
STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;QueueEndpoint=http://localhost:10001/devstoreaccount1;BlobEndpoint=http://localhost:10000/devstoreaccount1

# -----------------------------------------
# JWT Authentication
# -----------------------------------------
# SECURITY WARNING: Generate a secure random key for production!
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=development-secret-key-change-in-production-use-secrets-gen
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# -----------------------------------------
# Google OAuth 2.0
# -----------------------------------------
# Setup instructions:
# 1. Go to https://console.cloud.google.com/
# 2. Create/select project
# 3. Enable Google+ API
# 4. Go to Credentials â†’ Create OAuth 2.0 Client ID
# 5. Set application type to "Web application"
# 6. Add authorized redirect URIs:
#    - Local: http://localhost:8000/api/auth/google/callback
#    - Prod: https://yourdomain.com/api/auth/google/callback
# 7. Copy Client ID and Secret below
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:8000/api/auth/google/callback

# -----------------------------------------
# Frontend Configuration
# -----------------------------------------
FRONTEND_URL=http://localhost:5173

# -----------------------------------------
# Password Validation Rules
# -----------------------------------------
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=1
PASSWORD_REQUIRE_NUMBER=1

# -----------------------------------------
# Rate Limiting
# -----------------------------------------
RATE_LIMIT_MAX_ATTEMPTS=5
RATE_LIMIT_LOCKOUT_MINUTES=15

# -----------------------------------------
# Security
# -----------------------------------------
# Set to 1 in production with HTTPS
COOKIE_SECURE=0
COOKIE_SAMESITE=lax

# -----------------------------------------
# Debug/Development
# -----------------------------------------
DEBUG=1
LOG_LEVEL=debug

# -----------------------------------------
# UWM Instant Price Quote API
# -----------------------------------------
# OAuth 2.0 authentication credentials (obtain from UWM)
# Token endpoint: https://sso.uwm.com/adfs/oauth2/token
# Bearer token expires: 1 hour, Refresh token expires: 16 hours
UWM_SSO_URL=https://sso.uwm.com/adfs/oauth2/token
UWM_API_URL=https://api.uwm.com/instantpricequote/v1/pricequote
UWM_USERNAME=
UWM_PASSWORD=
UWM_CLIENT_ID=
UWM_CLIENT_SECRET=

# Environment determines OAuth scope:
# - dev: https://api.uwm.com/loanorigination-int
# - staging: https://api.uwm.com/loanorigination-stg
# - production: https://api.uwm.com/loanorigination
UWM_ENVIRONMENT=dev

# API request timeout in seconds
UWM_API_TIMEOUT=30

# Feature flag: Set to 1 to use real UWM API, 0 for mock responses
UWM_USE_REAL_API=0

# SOCKS5 proxy for UWM API (only used when ENVIRONMENT=development)
# Start tunnel on host: ./scripts/tunnel.sh
# Gateway IP: Use your Docker network gateway (check: docker network inspect valargen-main_valargen-network)
# Common values: 172.20.0.1 (valargen network) or 172.17.0.1 (default bridge)
# Ignored in staging/production (uses direct connection with whitelisted IP)
UWM_PROXY_URL=socks5://172.20.0.1:1080
